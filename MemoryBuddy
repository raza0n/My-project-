from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.label import Label
from kivy.uix.textinput import TextInput
from kivy.uix.button import Button
from kivy.uix.scrollview import ScrollView


class MemoryBuddyApp(App):
    def build(self):
        self.medications = []
        self.appointments = []

        # Main layout
        main_layout = BoxLayout(orientation="vertical", padding=10, spacing=10)

        # Medications section
        main_layout.add_widget(Label(text="Add Medication", font_size=18))
        self.med_name_input = TextInput(hint_text="Medication Name", multiline=False)
        self.med_time_input = TextInput(hint_text="Medication Time (e.g., 08:00 AM)", multiline=False)
        add_med_button = Button(text="Add Medication", size_hint=(1, 0.5), on_press=self.add_medication)

        main_layout.add_widget(self.med_name_input)
        main_layout.add_widget(self.med_time_input)
        main_layout.add_widget(add_med_button)

        # Appointments section
        main_layout.add_widget(Label(text="Add Appointment", font_size=18))
        self.app_type_input = TextInput(hint_text="Appointment Type (Doctor/Pharmacy)", multiline=False)
        self.app_time_input = TextInput(hint_text="Appointment Date and Time (e.g., 2024-12-05 10:00 AM)", multiline=False)
        add_app_button = Button(text="Add Appointment", size_hint=(1, 0.5), on_press=self.add_appointment)

        main_layout.add_widget(self.app_type_input)
        main_layout.add_widget(self.app_time_input)
        main_layout.add_widget(add_app_button)

        # Display area
        self.display_area = ScrollView(size_hint=(1, 2))
        self.display_layout = BoxLayout(orientation="vertical", size_hint_y=None)
        self.display_layout.bind(minimum_height=self.display_layout.setter('height'))
        self.display_area.add_widget(self.display_layout)
        main_layout.add_widget(self.display_area)

        return main_layout

    def add_medication(self, instance):
        med_name = self.med_name_input.text
        med_time = self.med_time_input.text

        if med_name and med_time:
            self.medications.append(f"{med_name} - {med_time}")
            self.update_display(f"Medication added: {med_name} at {med_time}")
            self.med_name_input.text = ""
            self.med_time_input.text = ""

    def add_appointment(self, instance):
        app_type = self.app_type_input.text
        app_time = self.app_time_input.text

        if app_type and app_time:
            self.appointments.append(f"{app_type} - {app_time}")
            self.update_display(f"Appointment added: {app_type} at {app_time}")
            self.app_type_input.text = ""
            self.app_time_input.text = ""

    def update_display(self, message):
        self.display_layout.add_widget(Label(text=message, size_hint_y=None, height=40))


if _name_ == "_main_":
    MemoryBuddyApp().run()
